# bo

<div align="center">

**凯利公式计算器**

支持标准投注、Polymarket 预测市场、股票交易和套利/抽水计算的仓位管理工具

[![Release](https://img.shields.io/github/v/release/inoader/bo)](https://github.com/inoader/bo/releases/latest)
[![Build](https://img.shields.io/github/actions/workflow/status/inoader/bo/release.yml?branch=main)](https://github.com/inoader/bo/actions)

</div>

## 功能特性

- **标准模式** - 赔率 + 胜率计算凯利公式
- **Polymarket 模式** - 针对预测市场优化，直接输入市场价格和你的概率
- **股票交易模式** - 基于当前价/止盈价/止损价计算仓位
- **套利检测** - 双边或多边套利机会计算
- **抽水分析** - 无套利时显示庄家抽水率
- 交互式和命令行两种使用方式
- 提供全凯利、半凯利、1/4凯利仓位建议

## 安装

### 方式一：下载预编译二进制

从 [Releases](https://github.com/inoader/bo/releases) 页面下载对应平台的二进制文件：

```bash
# Linux
wget https://github.com/inoader/bo/releases/latest/download/bo-x86_64-linux
chmod +x bo-x86_64-linux
mv bo-x86_64-linux bo

# macOS (Intel)
wget https://github.com/inoader/bo/releases/latest/download/bo-x86_64-apple-darwin
chmod +x bo-x86_64-apple-darwin
mv bo-x86_64-apple-darwin bo

# macOS (Apple Silicon)
wget https://github.com/inoader/bo/releases/latest/download/bo-aarch64-apple-darwin
chmod +x bo-aarch64-apple-darwin
mv bo-aarch64-apple-darwin bo

# Windows
# 下载 bo-x86_64-windows.exe 并重命名为 bo.exe
```

### 方式二：从源码编译

```bash
git clone https://github.com/inoader/bo.git
cd bo
cargo build --release
```

二进制文件位于 `target/release/bo`。

## 使用方法

### 标准模式

```bash
bo <赔率> <胜率> [本金]
```

```bash
bo 2.0 60              # 赔率2.0，胜率60%
bo 2.0 60 10000        # 本金10000
```

**输出示例：**
```
──────────────────────────────────────────────────
                        计算结果
──────────────────────────────────────────────────

  输入参数:
    ├─ 赔率: 2.00
    ├─ 净赔率 (b): 1.00
    └─ 胜率 (p): 60.00%

  分析:
    ├─ 期望收益 (EV): 20.00%
    ├─ 状态: ✓ 正期望值 (值得下注)
    └─ 仓位建议: 20.00%

  基于本金 10000.00 的投注金额:
    ├─ 全凯利: 2000.00
    ├─ 半凯利: 1000.00
    └─ 1/4凯利: 500.00
```

### Polymarket 模式

```bash
bo -p <市场价格> <你的概率> [本金]
```

```bash
bo -p 60 75            # 市场价格60c，你认为75%
bo -p 60 75 1000       # 本金1000
```

### 股票交易模式

```bash
bo -s <当前价> <止盈价> <止损价> <胜率> [本金]
```

```bash
bo -s 100 120 90 60            # 当前价100，止盈120，止损90，胜率60%
bo -s 100 120 90 60 10000       # 本金10000
```

**输出示例：**
```
──────────────────────────────────────────────────
                        股票交易计算结果
──────────────────────────────────────────────────

  输入参数:
    ├─ 当前价: 100.00
    ├─ 止盈价: 120.00
    ├─ 止损价: 90.00
    └─ 胜率 (p): 60.00%

  风险分析:
    ├─ 预期收益: 20.00
    ├─ 风险: 10.00
    └─ 盈亏比: 2.00

  分析:
    ├─ 净赔率 (b): 2.00
    ├─ 期望收益 (EV): 60.00%
    ├─ 状态: ✓ 正期望值 (值得交易)
    └─ 仓位建议: 70.00%
```

### 套利/抽水模式（双边）

```bash
bo -a <赔率1> <赔率2> [本金]
```

- **隐含概率之和 < 100%** → 显示套利机会和投注方案
- **隐含概率之和 > 100%** → 显示庄家抽水率

```bash
bo -a 2.1 2.2            # 有套利机会
bo -a 1.9 1.9            # 无套利，显示抽水
bo -a 2.1 2.2 1000       # 本金1000
```

**输出示例（有套利）：**
```
✓ 套利机会存在！
├─ 套利收益率: 2.44%
├─ 方案1投注比例: 51.22%
└─ 方案2投注比例: 48.78%

基于本金 1000.00 的投注方案:
├─ 方案1投注: 512.20
├─ 方案2投注: 487.80
└─ 获胜总回报: 1024.39 (收益: 24.39)
```

### 多标的套利/抽水模式

```bash
bo -A <标的数量> <赔率1> <赔率2> ... <赔率N> [本金]
```

适用于多选项（如足球胜平负、多匹马赛跑等）的套利或抽水计算。

```bash
bo -A 3 2.5 4.0 5.0            # 3个标的，有套利
bo -A 3 2.0 3.5 4.0            # 3个标的，显示抽水
bo -A 3 2.5 4.0 5.0 1000       # 本金1000
```

### 交互式模式

不带参数或仅带模式标志即可进入交互式模式：

```bash
bo              # 标准模式交互
bo -p           # Polymarket 交互
bo -s           # 股票交易交互
bo -a           # 套利交互
bo -A           # 多标的套利交互
```

## 公式说明

### 凯利公式

```
f* = (bp - q) / b
```

- `b` = 净赔率（赔率 - 1）
- `p` = 胜率
- `q` = 败率（1 - p）
- `f*` = 最优仓位比例

### Polymarket 变体

```
隐含赔率 = (1 - 市场价格) / 市场价格
f* = (隐含赔率 × 你的概率 - (1 - 你的概率)) / 隐含赔率
```

### 套利检测

```
隐含概率 = 1 / 赔率
套利条件: Σ隐含概率 < 100%
套利收益率 = (1 / Σ隐含概率) - 1

双边投注比例:
方案1投注比例 = 赔率2 / (赔率1 + 赔率2)
方案2投注比例 = 赔率1 / (赔率1 + 赔率2)

多边投注比例:
标的i投注比例 = (1 / 赔率i) / Σ隐含概率
```

