# bo - 凯利公式计算器

支持标准投注、Polymarket 预测市场、股票交易和套利的仓位管理工具。

## 功能

- **标准模式**: 赔率 + 胜率计算凯利公式
- **Polymarket 模式**: 针对预测市场优化
- **股票交易模式**: 基于买入价/止盈价/止损价计算仓位
- **套利模式**: 计算两边赔率的套利机会和最优投注比例
- 交互式和命令行模式
- 仓位建议（全凯利、半凯利、1/4凯利）

## 安装

```bash
cargo build --release
```

二进制文件位于 `target/release/bo`。

## 使用

### 标准模式

```bash
./bo <赔率> <胜率> [本金]
```

示例：
```bash
./bo 2.0 60              # 赔率2.0，胜率60%
./bo 2.0 60 10000        # 本金10000
```

### Polymarket 模式

```bash
./bo -p <市场价格> <你的概率> [本金]
```

示例：
```bash
./bo -p 60 75            # 市场价格60c，你认为75%
./bo -p 60 75 1000       # 本金1000
```

### 股票交易模式

```bash
./bo -s <当前价> <止盈价> <止损价> <胜率> [本金]
```

示例：
```bash
./bo -s 100 120 90 60            # 当前价100，止盈120，止损90，胜率60%
./bo -s 100 120 90 60 10000       # 本金10000
```

### 套利模式（双边）

```bash
./bo -a <赔率1> <赔率2> [本金]
```

当两边赔率的隐含概率之和小于 100% 时存在套利机会。

示例：
```bash
./bo -a 2.1 2.2                  # 方案1赔率2.1，方案2赔率2.2
./bo -a 2.1 2.2 1000             # 本金1000
```

### 多标的套利模式

```bash
./bo -A <标的数量> <赔率1> <赔率2> ... <赔率N> [本金]
```

适用于多选项（如足球胜平负、多匹马赛跑等）的套利计算。

示例：
```bash
./bo -A 3 2.5 4.0 5.0            # 3个标的，赔率分别为2.5, 4.0, 5.0
./bo -A 3 2.5 4.0 5.0 1000       # 本金1000
```

输出示例：
```
✓ 套利机会存在！
├─ 套利收益率: 17.65%
└─ 投注比例分配:
   ├─ 标的1: 47.06%
   ├─ 标的2: 29.41%
   └─ 标的3: 23.53%

基于本金 1000.00 的投注方案:
├─ 标的1投注: 470.59
├─ 标的2投注: 294.12
├─ 标的3投注: 235.29
└─ 获胜总回报: 1176.47 (收益: 176.47)
```

### 交互式模式

```bash
./bo              # 标准模式
./bo -p           # Polymarket
./bo -s           # 股票交易
./bo -a           # 套利
./bo -A           # 多标的套利
```

## 凯利公式

**标准模式：**
```
f* = (bp - q) / b
```
- `b` = 净赔率 (赔率 - 1)
- `p` = 胜率
- `q` = 败率 (1 - p)

**Polymarket：**
```
f* = (你的概率 - 市场价格) / (1 - 市场价格)
```

**股票交易：**
```
b = (止盈价 - 当前价) / (当前价 - 止损价)  // 盈亏比
f* = (bp - q) / b
```

**套利模式：**
```
隐含概率 = 1 / 赔率
套利条件: 隐含概率之和 < 100%
套利收益率 = (1 / 总隐含概率) - 1

双边投注比例:
方案1投注比例 = 赔率2 / (赔率1 + 赔率2)
方案2投注比例 = 赔率1 / (赔率1 + 赔率2)

多边投注比例:
标的i投注比例 = (1 / 赔率i) / 总隐含概率
```
